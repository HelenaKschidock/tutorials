name: Run tutorials with all components from containers
on:
  push:
    branches:
      - add-nightly-tests
jobs:
  run-flow-over-heated-plate:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/precice/openfoam-adapter:latest
      options: --user precice --workdir /home/precice
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
        with:
          path: /home/precice
      - name: Run an OpenFOAM-OpenFOAM case
        run: |
          cd flow-over-heated-plate/
          (cd fluid-openfoam && /usr/bin/openfoam2012 ./run.sh &)
          (cd solid-openfoam && /usr/bin/openfoam2012 ./run.sh &)  
        